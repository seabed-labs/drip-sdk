{
  "version": "0.1.0",
  "name": "drip",
  "instructions": [
    {
      "name": "initVaultProtoConfig",
      "accounts": [
        {
          "name": "vaultProtoConfig",
          "isMut": true,
          "isSigner": true
        },
        {
          "name": "creator",
          "isMut": true,
          "isSigner": true
        },
        {
          "name": "systemProgram",
          "isMut": false,
          "isSigner": false
        }
      ],
      "args": [
        {
          "name": "params",
          "type": {
            "defined": "InitVaultProtoConfigParams"
          }
        }
      ]
    },
    {
      "name": "initVault",
      "accounts": [
        {
          "name": "vault",
          "isMut": true,
          "isSigner": false
        },
        {
          "name": "vaultProtoConfig",
          "isMut": false,
          "isSigner": false
        },
        {
          "name": "tokenAAccount",
          "isMut": true,
          "isSigner": false
        },
        {
          "name": "tokenBAccount",
          "isMut": true,
          "isSigner": false
        },
        {
          "name": "treasuryTokenBAccount",
          "isMut": false,
          "isSigner": false
        },
        {
          "name": "tokenAMint",
          "isMut": false,
          "isSigner": false
        },
        {
          "name": "tokenBMint",
          "isMut": false,
          "isSigner": false
        },
        {
          "name": "creator",
          "isMut": true,
          "isSigner": true
        },
        {
          "name": "tokenProgram",
          "isMut": false,
          "isSigner": false
        },
        {
          "name": "associatedTokenProgram",
          "isMut": false,
          "isSigner": false
        },
        {
          "name": "systemProgram",
          "isMut": false,
          "isSigner": false
        },
        {
          "name": "rent",
          "isMut": false,
          "isSigner": false
        }
      ],
      "args": [
        {
          "name": "params",
          "type": {
            "defined": "InitializeVaultParams"
          }
        }
      ]
    },
    {
      "name": "initVaultPeriod",
      "accounts": [
        {
          "name": "vaultPeriod",
          "isMut": true,
          "isSigner": false
        },
        {
          "name": "vault",
          "isMut": false,
          "isSigner": false
        },
        {
          "name": "tokenAMint",
          "isMut": false,
          "isSigner": false
        },
        {
          "name": "tokenBMint",
          "isMut": false,
          "isSigner": false
        },
        {
          "name": "vaultProtoConfig",
          "isMut": false,
          "isSigner": false
        },
        {
          "name": "creator",
          "isMut": true,
          "isSigner": true
        },
        {
          "name": "systemProgram",
          "isMut": false,
          "isSigner": false
        }
      ],
      "args": [
        {
          "name": "params",
          "type": {
            "defined": "InitializeVaultPeriodParams"
          }
        }
      ]
    },
    {
      "name": "closePosition",
      "accounts": [
        {
          "name": "vault",
          "isMut": true,
          "isSigner": false
        },
        {
          "name": "vaultProtoConfig",
          "isMut": false,
          "isSigner": false
        },
        {
          "name": "vaultPeriodI",
          "isMut": false,
          "isSigner": false
        },
        {
          "name": "vaultPeriodJ",
          "isMut": false,
          "isSigner": false
        },
        {
          "name": "vaultPeriodUserExpiry",
          "isMut": true,
          "isSigner": false
        },
        {
          "name": "userPosition",
          "isMut": true,
          "isSigner": false
        },
        {
          "name": "vaultTokenAAccount",
          "isMut": true,
          "isSigner": false
        },
        {
          "name": "vaultTokenBAccount",
          "isMut": true,
          "isSigner": false
        },
        {
          "name": "vaultTreasuryTokenBAccount",
          "isMut": true,
          "isSigner": false
        },
        {
          "name": "userTokenBAccount",
          "isMut": true,
          "isSigner": false
        },
        {
          "name": "userTokenAAccount",
          "isMut": true,
          "isSigner": false
        },
        {
          "name": "userPositionNftAccount",
          "isMut": true,
          "isSigner": false
        },
        {
          "name": "userPositionNftMint",
          "isMut": true,
          "isSigner": false
        },
        {
          "name": "tokenAMint",
          "isMut": false,
          "isSigner": false
        },
        {
          "name": "tokenBMint",
          "isMut": false,
          "isSigner": false
        },
        {
          "name": "withdrawer",
          "isMut": false,
          "isSigner": true
        },
        {
          "name": "tokenProgram",
          "isMut": false,
          "isSigner": false
        },
        {
          "name": "systemProgram",
          "isMut": false,
          "isSigner": false
        }
      ],
      "args": []
    },
    {
      "name": "deposit",
      "accounts": [
        {
          "name": "vault",
          "isMut": true,
          "isSigner": false
        },
        {
          "name": "vaultPeriodEnd",
          "isMut": true,
          "isSigner": false
        },
        {
          "name": "userPosition",
          "isMut": true,
          "isSigner": false
        },
        {
          "name": "tokenAMint",
          "isMut": false,
          "isSigner": false
        },
        {
          "name": "userPositionNftMint",
          "isMut": true,
          "isSigner": true
        },
        {
          "name": "vaultTokenAAccount",
          "isMut": true,
          "isSigner": false
        },
        {
          "name": "userTokenAAccount",
          "isMut": true,
          "isSigner": false
        },
        {
          "name": "userPositionNftAccount",
          "isMut": true,
          "isSigner": false
        },
        {
          "name": "depositor",
          "isMut": true,
          "isSigner": true
        },
        {
          "name": "tokenProgram",
          "isMut": false,
          "isSigner": false
        },
        {
          "name": "associatedTokenProgram",
          "isMut": false,
          "isSigner": false
        },
        {
          "name": "rent",
          "isMut": false,
          "isSigner": false
        },
        {
          "name": "systemProgram",
          "isMut": false,
          "isSigner": false
        }
      ],
      "args": [
        {
          "name": "params",
          "type": {
            "defined": "DepositParams"
          }
        }
      ]
    },
    {
      "name": "withdrawB",
      "accounts": [
        {
          "name": "vault",
          "isMut": false,
          "isSigner": false
        },
        {
          "name": "vaultProtoConfig",
          "isMut": false,
          "isSigner": false
        },
        {
          "name": "vaultPeriodI",
          "isMut": false,
          "isSigner": false
        },
        {
          "name": "vaultPeriodJ",
          "isMut": false,
          "isSigner": false
        },
        {
          "name": "userPosition",
          "isMut": true,
          "isSigner": false
        },
        {
          "name": "userPositionNftAccount",
          "isMut": false,
          "isSigner": false
        },
        {
          "name": "vaultTokenBAccount",
          "isMut": true,
          "isSigner": false
        },
        {
          "name": "userTokenBAccount",
          "isMut": true,
          "isSigner": false
        },
        {
          "name": "vaultTreasuryTokenBAccount",
          "isMut": true,
          "isSigner": false
        },
        {
          "name": "userPositionNftMint",
          "isMut": false,
          "isSigner": false
        },
        {
          "name": "tokenBMint",
          "isMut": false,
          "isSigner": false
        },
        {
          "name": "withdrawer",
          "isMut": false,
          "isSigner": true
        },
        {
          "name": "tokenProgram",
          "isMut": false,
          "isSigner": false
        },
        {
          "name": "associatedTokenProgram",
          "isMut": false,
          "isSigner": false
        }
      ],
      "args": []
    },
    {
      "name": "triggerDca",
      "accounts": [
        {
          "name": "dcaTriggerSource",
          "isMut": false,
          "isSigner": true
        },
        {
          "name": "vault",
          "isMut": true,
          "isSigner": false
        },
        {
          "name": "vaultProtoConfig",
          "isMut": false,
          "isSigner": false
        },
        {
          "name": "lastVaultPeriod",
          "isMut": false,
          "isSigner": false
        },
        {
          "name": "currentVaultPeriod",
          "isMut": true,
          "isSigner": false
        },
        {
          "name": "swapTokenMint",
          "isMut": true,
          "isSigner": false
        },
        {
          "name": "tokenAMint",
          "isMut": false,
          "isSigner": false
        },
        {
          "name": "tokenBMint",
          "isMut": false,
          "isSigner": false
        },
        {
          "name": "vaultTokenAAccount",
          "isMut": true,
          "isSigner": false
        },
        {
          "name": "vaultTokenBAccount",
          "isMut": true,
          "isSigner": false
        },
        {
          "name": "swapTokenAAccount",
          "isMut": true,
          "isSigner": false
        },
        {
          "name": "swapTokenBAccount",
          "isMut": true,
          "isSigner": false
        },
        {
          "name": "swapFeeAccount",
          "isMut": true,
          "isSigner": false
        },
        {
          "name": "dcaTriggerFeeTokenAAccount",
          "isMut": true,
          "isSigner": false
        },
        {
          "name": "swap",
          "isMut": false,
          "isSigner": false
        },
        {
          "name": "swapAuthority",
          "isMut": false,
          "isSigner": false
        },
        {
          "name": "tokenSwapProgram",
          "isMut": false,
          "isSigner": false
        },
        {
          "name": "tokenProgram",
          "isMut": false,
          "isSigner": false
        },
        {
          "name": "associatedTokenProgram",
          "isMut": false,
          "isSigner": false
        },
        {
          "name": "systemProgram",
          "isMut": false,
          "isSigner": false
        },
        {
          "name": "rent",
          "isMut": false,
          "isSigner": false
        }
      ],
      "args": []
    }
  ],
  "accounts": [
    {
      "name": "Position",
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "vault",
            "type": "publicKey"
          },
          {
            "name": "positionAuthority",
            "type": "publicKey"
          },
          {
            "name": "depositedTokenAAmount",
            "type": "u64"
          },
          {
            "name": "withdrawnTokenBAmount",
            "type": "u64"
          },
          {
            "name": "depositTimestamp",
            "type": "i64"
          },
          {
            "name": "dcaPeriodIdBeforeDeposit",
            "type": "u64"
          },
          {
            "name": "numberOfSwaps",
            "type": "u64"
          },
          {
            "name": "periodicDripAmount",
            "type": "u64"
          },
          {
            "name": "isClosed",
            "type": "bool"
          },
          {
            "name": "bump",
            "type": "u8"
          }
        ]
      }
    },
    {
      "name": "Vault",
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "protoConfig",
            "type": "publicKey"
          },
          {
            "name": "tokenAMint",
            "type": "publicKey"
          },
          {
            "name": "tokenBMint",
            "type": "publicKey"
          },
          {
            "name": "tokenAAccount",
            "type": "publicKey"
          },
          {
            "name": "tokenBAccount",
            "type": "publicKey"
          },
          {
            "name": "treasuryTokenBAccount",
            "type": "publicKey"
          },
          {
            "name": "whitelistedSwaps",
            "type": {
              "array": ["publicKey", 5]
            }
          },
          {
            "name": "lastDcaPeriod",
            "type": "u64"
          },
          {
            "name": "dripAmount",
            "type": "u64"
          },
          {
            "name": "dcaActivationTimestamp",
            "type": "i64"
          },
          {
            "name": "bump",
            "type": "u8"
          },
          {
            "name": "limitSwaps",
            "type": "bool"
          }
        ]
      }
    },
    {
      "name": "VaultPeriod",
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "vault",
            "type": "publicKey"
          },
          {
            "name": "periodId",
            "type": "u64"
          },
          {
            "name": "dar",
            "type": "u64"
          },
          {
            "name": "twap",
            "type": "u128"
          },
          {
            "name": "bump",
            "type": "u8"
          }
        ]
      }
    },
    {
      "name": "VaultProtoConfig",
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "granularity",
            "type": "u64"
          },
          {
            "name": "triggerDcaSpread",
            "type": "u16"
          },
          {
            "name": "baseWithdrawalSpread",
            "type": "u16"
          }
        ]
      }
    }
  ],
  "types": [
    {
      "name": "DepositParams",
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "tokenADepositAmount",
            "type": "u64"
          },
          {
            "name": "dcaCycles",
            "type": "u64"
          }
        ]
      }
    },
    {
      "name": "InitializeVaultParams",
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "whitelistedSwaps",
            "type": {
              "vec": "publicKey"
            }
          }
        ]
      }
    },
    {
      "name": "InitializeVaultPeriodParams",
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "periodId",
            "type": "u64"
          }
        ]
      }
    },
    {
      "name": "InitVaultProtoConfigParams",
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "granularity",
            "type": "u64"
          },
          {
            "name": "triggerDcaSpread",
            "type": "u16"
          },
          {
            "name": "baseWithdrawalSpread",
            "type": "u16"
          }
        ]
      }
    }
  ],
  "events": [
    {
      "name": "Log",
      "fields": [
        {
          "name": "data",
          "type": {
            "option": "u64"
          },
          "index": false
        },
        {
          "name": "message",
          "type": "string",
          "index": true
        }
      ]
    }
  ],
  "errors": [
    {
      "code": 6000,
      "name": "CannotGetPositionBump",
      "msg": "Cannot get position bump"
    },
    {
      "code": 6001,
      "name": "CannotGetVaultBump",
      "msg": "Cannot get vault bump"
    },
    {
      "code": 6002,
      "name": "CannotGetVaultPeriodBump",
      "msg": "Cannot get vault_period bump"
    },
    {
      "code": 6003,
      "name": "DuplicateDCAError",
      "msg": "DCA already triggered for the current period"
    },
    {
      "code": 6004,
      "name": "IncompleteSwapError",
      "msg": "Swap did not complete"
    },
    {
      "code": 6005,
      "name": "InvalidGranularity",
      "msg": "Granularity must be an integer larger than 0"
    },
    {
      "code": 6006,
      "name": "InvalidMint",
      "msg": "Token mint does not match expected value"
    },
    {
      "code": 6007,
      "name": "InvalidSpread",
      "msg": "Spread must be >=0 and <=10000"
    },
    {
      "code": 6008,
      "name": "InvalidSwapAccount",
      "msg": "Token Swap is Not Whitelisted"
    },
    {
      "code": 6009,
      "name": "InvalidNumSwaps",
      "msg": "A Vault May Limit to a Maximum of 5 Token Swaps"
    },
    {
      "code": 6010,
      "name": "InvalidVaultProtoConfigReference",
      "msg": "Provided account references the wrong vault-proto-config"
    },
    {
      "code": 6011,
      "name": "InvalidSwapAuthorityAccount",
      "msg": "Invalid swap authority account"
    },
    {
      "code": 6012,
      "name": "InvalidSwapFeeAccount",
      "msg": "Invalid swap fee account"
    },
    {
      "code": 6013,
      "name": "InvalidVaultPeriod",
      "msg": "Invalid vault-period"
    },
    {
      "code": 6014,
      "name": "InvalidVaultReference",
      "msg": "Provided account references the wrong vault"
    },
    {
      "code": 6015,
      "name": "PeriodicDripAmountIsZero",
      "msg": "Periodic drip amount == 0"
    },
    {
      "code": 6016,
      "name": "PositionAlreadyClosed",
      "msg": "Position is already closed"
    },
    {
      "code": 6017,
      "name": "WithdrawableAmountIsZero",
      "msg": "Withdrawable amount is zero"
    }
  ]
}
